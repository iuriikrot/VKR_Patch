# VKR: PatchTST для портфельной оптимизации Марковица

## Тема исследования
Применение модели PatchTST для прогнозирования ожидаемых доходностей в задаче портфельной оптимизации по Марковицу.

## Цель
Эмпирически проверить гипотезу о том, что замена исторических средних на прогнозы модели PatchTST в качестве оценки ожидаемых доходностей улучшает качество портфеля Марковица.

## Формальная постановка

**Классическая задача Марковица** - максимизация коэффициента Шарпа:

```
max  (w'μ - r_f) / √(w'Σw)
s.t. Σw_i = 1, w_i ≥ 0
```

где:
- **w** — вектор весов активов
- **μ** — вектор ожидаемых доходностей ← *здесь вносится изменение*
- **Σ** — ковариационная матрица доходностей
- **r_f** — безрисковая ставка

## Подходы к оценке μ

| Подход | Оценка μ | Назначение |
|--------|----------|------------|
| Baseline 1 | Историческое среднее (252 дня) | Классический Марковиц |
| Baseline 2 | Прогноз ARIMA(p,d,q) | Традиционный эконометрический подход |
| **Предлагаемый** | **Прогноз PatchTST** | **Современный ML-подход** |

## Данные

- **Активы:** 10 акций из разных секторов S&P 500
- **Период:** 2000-2025 (25 лет)
- **Training:** скользящее окно 5 лет
- **Test:** 1 месяц вперёд
- **Источник:** Yahoo Finance (Adjusted Close)

## Структура проекта

```
VKR_Patch/
├── data/               # Загруженные данные
├── src/
│   ├── data/           # Загрузка и предобработка данных
│   ├── models/         # Модели (PatchTST, ARIMA, Historical)
│   ├── optimization/   # Оптимизатор Марковица
│   └── backtesting/    # Бэктестинг
├── notebooks/          # Jupyter notebooks для анализа
├── results/            # Результаты экспериментов
└── tests/              # Тесты
```

## Установка

```bash
pip install -r requirements.txt
```

## Запуск

```bash
python main.py
```
